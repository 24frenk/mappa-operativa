<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <title>Mappa Operativa â€“ Admin</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

<!-- ============================================================
     LOGIN ADMIN (PIN 240895)
============================================================ -->
<div id="login-screen">
    <div id="login-box">
        <h2>Accesso Admin</h2>
        <p>Inserisci PIN:</p>
        <input type="password" id="admin-pin">
        <button onclick="checkPIN()">Accedi</button>
        <div id="login-error"></div>
    </div>
</div>

<!-- ============================================================
     TOP BAR
============================================================ -->
<div id="top-bar" style="display:none;">
    <div id="sync-info" style="font-size:12px;">
        <span id="sync-state">Stato: â€”</span> |
        <span id="sync-last">Ultimo aggiornamento: â€”</span>
    </div>

    <div class="top-left">
        <button onclick="addBox('postazione')">ğŸ“ Postazione</button>
        <button onclick="addBox('ambulanza')">ğŸš‘ Ambulanza</button>
        <button onclick="addBox('squadra')">â›‘ï¸ Squadra</button>
        <button onclick="addBox('pma')">ğŸ¥ PMA</button>
    </div>

    <div class="top-right">
        <span>Carica mappa:</span>
        <input type="file" id="mapLoader" accept="image/*">
        <span>Scala:</span>
        <input type="range" id="mapScale" min="20" max="200" value="100">
        <button id="lockMapBtn" onclick="toggleMapLock()">Blocca mappa</button>

        <button onclick="openSettings()">âš™ï¸ Impostazioni</button>
    </div>
</div>

<!-- ============================================================
     MAIN LAYOUT
============================================================ -->
<div id="main" style="display:none;">

    <div id="sidebar">
        <div id="sidebar-content"></div>
    </div>

    <div id="map-wrapper">
        <div id="map-container">
            <img id="map-image" alt="Mappa">
        </div>
    </div>
</div>

<!-- ============================================================
     POPUP UNITÃ€
============================================================ -->
<div id="popup">
    <div id="popup-inner">
        <div id="popup-header">
            <h2 id="popup-title"></h2>
            <button id="popup-close" onclick="closePopup()">Ã—</button>
        </div>

        <div id="popup-content"></div>

        <div id="popup-footer">
            <div class="popup-footer-left">
                <button id="popup-save-btn" onclick="savePopup()">Salva</button>
            </div>

            <div class="popup-footer-center">
                <button id="popup-standby-btn" onclick="toggleStandby()">Standby</button>
                <button id="popup-end-intervento-btn" onclick="terminaIntervento()">Intervento terminato</button>
                <button id="popup-end-supporto-btn" onclick="terminaSupporto()">Richiesta supporto terminata</button>
                <button id="popup-remove-btn" onclick="removeCurrentUnit()">Rimuovi</button>
            </div>

            <div class="popup-footer-right">
                <button onclick="closePopup()">Chiudi</button>
            </div>
        </div>
    </div>
</div>

<!-- ============================================================
     POPUP IMPOSTAZIONI / SYNC
============================================================ -->
<div id="settings-popup">
    <div id="settings-inner">
        <h2>Impostazioni</h2>

        <label>Repo GitHub (owner/repo):</label>
        <input type="text" id="githubRepo">

        <label>Token:</label>
        <input type="password" id="githubToken">

        <button onclick="saveGitCredentials()">ğŸ’¾ Salva</button>
        <button onclick="syncToGitHub()">ğŸ”„ Sync</button>
        <button onclick="closeSettings()">Chiudi</button>
    </div>
</div>

<script src="app.js"></script>

<div id="sync-status" style="
    position: fixed;
    bottom: 5px;
    right: 10px;
    background: rgba(0,0,0,0.6);
    color: white;
    padding: 4px 10px;
    border-radius: 6px;
    font-size: 12px;
    display: none;
    z-index: 9999;
"></div>

</body>
</html>
